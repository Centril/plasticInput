/* jQuery PlasticInput, license: GPL 3.0 http://www.gnu.org/licenses/gpl-3.0.html copyright: Mazdak Farrokhzad <twingoow@gmail.com> */
(function(a){function b(b,d){a(b===document?document.documentElement:b)[d?"bind":"unbind"]("mousedown",function(){a(this).is(":focus")||a(this).data("focusFromMouse",!0)});return!0}a.focusFrom={manual:0,mouse:1,keyboard:2};a.each({focus:"iFocus",focusin:"iFocusin"},function(f,d){a.event.special[d]={setup:function(){return b(this,!0)},teardown:function(){return b(this,!1)},add:function(b){b.focusHandler=function(d){if(d.hasOwnProperty("originalEvent")){var f=a(this);d.focusFrom=!0===f.data("focusFromMouse")? a.focusFrom.mouse:a.focusFrom.keyboard;f.removeData("focusFromMouse")}else d.focusFrom=a.focusFrom.manual;return b.handler.apply(this,arguments)};a(this).bind(f,b.data,b.focusHandler)},remove:function(b){a(this).unbind(f,b.focusHandler)}}})})(jQuery);(function(){jQuery.fn.attrsFrom=function(a,b,f){var a=jQuery(a),d={},g=function(b,g){d[g]=(b=a.attr(g))&&f&&g in f?f[g].call(b,b,g):b};b?jQuery.each(b.split(" "),g):jQuery.each(a[0].attributes,function(a,b){g(a,b.name)});return jQuery(this).attr(d)}})(jQuery); (function(a){a.hooksManager=function(a){this.hookCollection=a};a.hooksManager.prototype={router:function(b,f,d){var g=void 0===d?"get":"set",k,l;for(k=this.length-1;-1<k;k--)if((l=(item=this[k])[g])&&(a.isFunction(item.predicate)?item.predicate(b):b.is(item.predicate)))return l(b,f,d)},register:function(b,f,d){if(b&&a.type(f)in{string:1,"function":1}&&("get"in d||"set"in d)){var g=this[b]||(this[b]=[]),k,l=this.hookCollection[b]||(this.hookCollection[b]={}),p={};for(b in{get:1,set:1})if((k=l[b])? !k.isRouter:b in d)k&&(p[b]=k,"set"===b&&g.push(a.extend(p,{isCore:!0,predicate:function(){return!0}}))),l[b]=a.proxy(this.router,g),l[b].isRouter=!0;g.push(a.extend({predicate:f},d));return g.length-1}},unregister:function(b,f){var d=this[b];d&&d.length&&("number"===a.type(f)&&!d[f].isCore?d.splice(f,1):d=a.grep(d,function(a){return a.isCore||item.predicate!==f}),d.length||(delete d[b],this.hookCollection[b]))}};a.each({val:a.valHooks,attr:a.attrHooks,prop:a.propHooks,css:a.cssHooks},function(b, f){a.hooksManager[b]=new a.hooksManager(f)})})(jQuery); (function(a){a.plasticInput={settings:{useLabel:!0,useOverlay:!0,forwardEvents:!0,file:{defaultText:"Please select a file...",clearTitle:"Clear!"},titleChangeTo:"text",optionTitleFromText:!0},classes:{base:"plasticInput",text:"plasticInput-text",password:"plasticInput-password",textarea:"plasticInput-textarea",select:"plasticInput-select",file:"plasticInput-file",radio:"plasticInput-radio",checkbox:"plasticInput-checkbox",bool:"plasticInput-bool",textWrapper:"textwrapper",overlay:"overlay",textBox:"text", textData:"text-data",focus:"focus",hover:"hover",innerBorder:"inner-border",fill:"fill",checked:"checked",clearFile:"clear",hasFile:"has-file",fileInput:"file",fileIcon:"icon",selectArrow:"arrow",dropdown:"dropdown",dropdownContent:"dropdown-content",selectOption:"option",selectOptionGroup:"option-group",selectBottom:"bottom",selectActive:"active"},valHookAdd:!0,valHookIndex:-1,currentSelectFocus:!1,elements:[]};a.support.selectOpacity=!(a.browser.msie&&7>a.browser.version);var b=a.plasticInput.classes, f=function(a,c,d){a.useOverlay&&d.append("<"+c+' class="'+b.overlay+'"/>');return d},d=function(m,c){a(this)[c.type===m[0]?"addClass":"removeClass"](b[m[1]||m[0]])},g=function(a){a.stopPropagation()},k=function(a){a.isPIForward||(a.isPIForward=!0,a.data.target.trigger(a));g(a)},l={"text password textarea|textarea":function(d,c,h){c.input=a("<"+("textarea"===c.type?c.type:'input type="'+c.type+'"')+' class="'+b.textBox+'"/>').appendTo(c.textWrapper).attrsFrom(d,"value"+("textarea"===c.type?"":" maxlength readonly")); "text"===c.type&&"text"===h.titleChangeTo&&c.input.bind("change.plasticInput",function(){c.textWrapper.attr("title",a.trim(c.input.val()))})},"checkbox radio":function(d,c){var h,e=function(c,d){return a.each(c,function(){var c=a(this);c.add(c.closest("."+b.base)).prop("checked",d).closest("."+b.textWrapper)[d?"addClass":"removeClass"](b.checked)})};a.extend(c,{input:a('<input class="'+b.textBox+'" type="'+c.type+'" tabindex="-1" />').appendTo(c.textWrapper).after('<div class="'+b.innerBorder+'"><div class="'+ b.fill+'"></div></div>'),isChecked:function(){return c.input.prop("checked")},set:function(b){b="boolean"===a.type(b)?b:!c.isChecked();if("radio"!==c.type||"radio"===c.type&&b)e(c.input,"radio"===c.type?!0:b).trigger("change")}});c.receiver=c.textWrapper.bind("keydown.plasticInput",function(b){32===b.which&&a(this).trigger("click")});"radio"===c.type&&(h=d.attr("name")).length&&a('input:radio[name="'+h+'"]').add(c.input).unbind("change.plasticInput-internal").bind("change.plasticInput-internal",function(){e(a('input:radio[name="'+ h+'"]').not(this),!1)});d.addClass(b.bool).prop("checked")&&c.set(!0);return{onStateChange:function(b,c){return{click:c?1:a.proxy(b.set,b)}}}},file:function(m,c,h){c.clear=function(d){d instanceof a.Event&&g(d);d=h.file.defaultText;c.textWrapper.removeClass(b.hasFile);e.text(d);c.input.replaceWith(f(c.input))};var e=a('<div class="'+b.textData+'">'+h.file.defaultText+"</div>"),f=function(h){return c.input=a('<input class="'+b.fileInput+'" type="file" />').attrsFrom(h,"title accept name tabindex accesskey").bind({"focus.plasticInput blur.plasticInput":a.proxy(d, c.textWrapper,["focus"]),"click.plasticInput":g,"change.plasticInput":function(){var d=a(this).val();c.textWrapper.addClass(b.hasFile);e.text(d)}})};a('<span class="'+b.clearFile+'" title="'+h.file.clearTitle+'">').appendTo(c.textWrapper.before(f(m))).before('<span class="'+b.fileIcon+'"></span>').after(a('<div class="'+b.textBox+'">').append(e)).bind("click.plasticInput",c.clear)},"select|select":function(m,c,h){var e=a('<div class="'+b.dropdown+'" tabindex="-1"></div>').insertAfter(c.textWrapper).bind("click.plasticInput", g),n=f(h,"li",a('<ul class="'+b.dropdownContent+'"></ul>')).appendTo(e);a.extend(c,{current:!1,hovered:!1,hoveredIndex:NaN,currentIndex:NaN,input:a('<input type="hidden" value="0"/>').insertBefore(c.textWrapper),toggle:function(i,j){var h,u;if(h=!(i instanceof a.Event)?i:"focusin"===i.type&&i.focusFrom===a.focusFrom.mouse?!1:("click"===i.type?e.is(":visible")?[j^=0,"blur"]:[0,"focusin"]:[g(i),i.type]).pop()){if("focusin"===h){if(e.is(":visible"))return;a.plasticInput.currentSelectFocus&&a.plasticInput.currentSelectFocus.data("plasticInput.select").toggle("blur"); a.plasticInput.currentSelectFocus=this.wrapper;a(document).unbind(".plasticInput-select-bind").bind("click.plasticInput-select-bind focusin.plasticInput-select-bind",function(i){i.target===document||a(i.target).parents("."+b.select).length&&a(i.target).parents("."+b.select).get(0)==c.wrapper.get(0)?c.textWrapper.trigger("focus"):(c.toggle("blur"),a(document).unbind(".plasticInput-select-bind"))});e.slideDown(1,function(){window.innerHeight+a(window).scrollTop()<e.offset().top+e.height()&&e.addClass(b.selectBottom)}); this.current&&this.scroll(this.current)}else e.slideUp(1,function(){e.removeClass(b.selectBottom)}),a.plasticInput.currentSelectFocus=!1,a(document).unbind(".plasticInput-select-bind"),this.hoveredIndex=NaN,this.hovered&&this.hovered.removeClass(b.hover);d.call(this.textWrapper,["focus"],{type:u="focusin"===h?"focus":"blur"});("focusin"===h?j:this.textWrapper.is(":focus"))&&this.textWrapper.trigger(u)}},append:function(i,j,d){var d=d||n,j=a(j||i),e;j.is("optgroup ")?(i=a('<li class="'+b.selectOptionGroup+ '">'+((e=j.attr("label"))&&e.length?"<h3>"+e+"</h3>":"")+"<ul></ul></li>").appendTo(d),d=i.children("ul"),j.children("option").each(function(a,b){c.append(a,b,d)})):(i=a('<li class="'+b.selectOption+'">'+(e=j.text())+"</li>").appendTo(d).attrsFrom(j,"title",{title:function(b,c){return a.trim(h.optionTitleFromText?e:c)}}).data("plasticInput:value",j.prop("value")).bind({"click.plasticInput":a.proxy(this.select,this),"mousemove.plasticInput":a.proxy(this.navigate,this)}),j.attr("selected")&&this.set(i)); j.prop("disabled")&&i.addClass("disabled").prop("disabled",!0)},getEnabledOptions:function(){return n.find("."+b.selectOption).not(this.isOptionDisabled)},isOptionDisabled:function(b,c){return a(c||b).closest(".disabled",n).length},navigate:function(a){var c,d=this.getEnabledOptions();if("mousemove"===a.type)c=d.index(a.currentTarget);else if("keydown"===a.type){if(33>a.which||41<a.which)return 13===a.which?this.select(a):null;a.preventDefault();var e=d.length-1;c=isNaN(this.hoveredIndex)?isNaN(this.currentIndex)? 0:this.currentIndex:this.hoveredIndex;if(36===a.which||(34===a.which?c+=Math.round(e/5):a.which in{40:1,39:1}?++c:!1)>e)c=0;else if(35===a.which||0>(33===a.which?c-=Math.round(e/5):a.which in{38:1,37:1}?--c:!1))c=e}else if("keypress"===a.type&&32<a.which&&!(a.altKey^a.ctrlKey)){var h=String.fromCharCode(a.which).toLowerCase(),f=d.length,m=isNaN(this.hoveredIndex)?isNaN(this.currentIndex)?0:this.currentIndex+1:this.hoveredIndex+1,g=m;do{if((e=d.eq(g).text()).length&&e[0].toLowerCase()===h){c=g;break}else g> f-2&&0!==m&&(g=0,f=m);g++}while(g<f)}void 0===c||this.hoveredIndex===c||(this.hovered&&this.hovered.removeClass(b.hover),this.hoveredIndex=c,this.hovered=d.eq(this.hoveredIndex).addClass(b.hover),"mousemove"!==a.type&&this.scroll(this.hovered))},set:function(c){var d;d=this.getEnabledOptions();if("number"===a.type(c)){if(!(d=d.eq(c)).length)return;this.currentIndex=c;c=d}else this.currentIndex=d.index(c);this.current&&this.current.removeClass(b.selectActive);this.current=c;this.input.val(c.data("plasticInput:value")).trigger("change"); this.wrapper.find("."+b.textData).html(d=a.trim(c.addClass(b.selectActive).text()));!1!==h.titleChangeTo&&this.textWrapper.attr("title","text"===h.titleChangeTo?d:a.trim(c.attr("title")))},select:function(b){var c="keydown"===b.type?this.hovered:a(b.currentTarget);this.isOptionDisabled(c)||(this.toggle("blur","keydown"===b.type),c.length&&!(c.length&&this.currentIndex===this.hoveredIndex)&&this.set(c))},scroll:function(a){e.scrollTo(a).scrollTo(this.getEnabledOptions().get(-1)===a.get(0)?"max":"-="+ 2*parseInt(a.css("margin-top"))+"px")}});c.receiver=c.textWrapper.bind("keydown.plasticInput keypress.plasticInput",a.proxy(c.navigate,c)).append('<div class="'+b.selectArrow+'"></div><div class="'+b.textBox+'"><div class="'+b.textData+'"></div></div>');var k=c.textWrapper.find("."+b.textData),l=function(){return!1};a(k).each(function(){this.onselectstart=this.ondragstart=l;a(this).mousedown(l).css({MozUserSelect:"none"})});m.children("option, optgroup").each(a.proxy(c.append,c));return{onStateChange:function(c, b){return{"iFocusin click":b?c.toggle("blur"):a.proxy(c.toggle,c)}}}}},p=["text",l["text password textarea|textarea"]],t=function(b,c,d,e){if(b.isDisabled!==c||e)if(b.isDisabled=c,b.textWrapper[c?"addClass":"removeClass"]("disabled").add(b.wrapper).add(b.input).attr("disabled",c),b.receiver.blur()[c?"bind":"unbind"]("focus.plasticInput-internal",c?function(){b.receiver.blur()}:void 0),d&&d.onStateChange){var f,d=d.onStateChange(b,c);for(f in d)b.receiver[c?"unbind":"bind"](f+".plasticInput",a.isFunction(d[f])? d[f]:void 0)}},v=function(m,c){a.plasticInput.valHookAdd&&-1===a.plasticInput.valHookIndex&&(a.plasticInput.valHookIndex=a.hooksManager.val.register("div",function(b){return!!a(b).data("plasticInput")},{get:function(b){return a(b).find(":input").val()},set:function(b,c){var d=a(b).data("plasticInput");return d.set?d.set(c):a(b).find(":input").val(c)}}));var h=this,e=a(m),n,q,s,i,j,r;this.wrapper=a("<div>").data("plasticInput",this);a.plasticInput.elements.push(this.wrapper[0]);e.after(this.wrapper).remove(); this.textWrapper=f(c,"div",a('<div class="'+b.textWrapper+'">').appendTo(this.wrapper));for(s in l)for(r=0;r<(i=s.split(" ")).length;r++)if(e.is(((j=i[r].split("|"))[1]||"input:"+j[0])+",."+b[j[0]])){this.type=j[0];q=l[s](e,this,c);break}this.type||(this.type=p[0],q=p[1](e,this,c));this.input.attrsFrom(e,"name");(this.receiver||(this.receiver=this.input)).attrsFrom(e,"tabindex accesskey");"select"!==this.type&&this.receiver.bind("focus.plasticInput blur.plasticInput",a.proxy(d,this.textWrapper,["focus"])); "file"!==this.type&&this.textWrapper.attrsFrom(e,"title");this.wrapper.attrsFrom(e,"id class",{"class":function(c){c=c?c.replace(RegExp("(^|\\s)"+b.base+"($|\\s)","ig"),""):"";return a.trim([c,b.base,b[h.type]].join(" "))}});c.useLabel&&(n=a('label[for="'+this.wrapper.attr("id")+'"]')).length&&n.bind({"click.plasticInput":function(a){g(a);h.receiver.trigger(h.receiver.is(":input")?"focus":"click",!0)},"mouseenter.plasticInput mouseleave.plasticInput":a.proxy(d,this.textWrapper,["mouseenter","hover"])}); c.forwardEvents&&(this.input.bind("change",{target:this.wrapper},k),this.receiver.bind("focus.plasticInput blur.plasticInput click.plasticInput",{target:this.wrapper},k),this.wrapper.bind("change.plasticInput",{target:this.input},k).bind("focus.plasticInput blur.plasticInput click.plasticInput",{target:this.receiver},k));t(this,!!e.attr("disabled"),q,!0);this.disable=function(){t(this,!0,q)};this.enable=function(){t(this,!1,q)};this.restore=function(){"select"===this.type?(this.input=this.wrapper.before(a("<select>").attrsFrom(input, "name value")).prev(),this.wrapper.find("."+b.selectOption).each(function(){var c=a(this);a("<option>").appendTo(input).text(c.text()).attrsFrom(c,"value title").attr("selected",c.is("."+b.selectActive)?"selected":void 0)})):(this.input.siblings().remove().end().unwrap(),"file"!==this.type&&this.input.unwrap()&&this.type in{radio:1,checkbox:1}&&this.wrapper.removeClass(b.bool));this.wrapper.removeClass(b[this.type]);this.input.attrsFrom(this.wrapper,"id class").attrsFrom(this.textWrapper,"title"+ (this.type in{select:1,radio:1,checkbox:1}?" tabindex accesskey":"")).add('label[for="'+this.wrapper.attr("id")+'"]').unbind(".plasticInput .plasticInput-internal");a.plasticInput.elements.splice(a.inArray(this.wrapper[0],a.plasticInput.elements),1);this.wrapper.remove();a.plasticInput.valHookAdd&&1>a.plasticInput.elements.length&&(a.hooksManager.val.unregister("div",a.plasticInput.valHookIndex),a.plasticInput.valHookIndex=-1)};return this};a.fn.plasticInput=function(b){if(!a.support.selectOpacity)return this; var c=arguments,d=!1,e="string"===a.type(b)?b:!1;return this.each(function(){var f=a(this).data("plasticInput");if(!f){if("restore"===b)return;d||(d=!0,b=a.extend(!0,{},a.plasticInput.settings,e?{}:b));f=new v(this,b)}e&&f[e].apply(f,c)})}})(jQuery);